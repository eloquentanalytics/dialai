"use strict";(globalThis.webpackChunkdialai_website=globalThis.webpackChunkdialai_website||[]).push([[4656],{4624(e,s,i){i.r(s),i.d(s,{assets:()=>c,contentTitle:()=>a,default:()=>p,frontMatter:()=>r,metadata:()=>n,toc:()=>l});const n=JSON.parse('{"id":"api/intro","title":"API Reference","description":"The DialAI API provides 12 functions for creating sessions, registering specialists, and managing the decision cycle. Functions that invoke strategy functions (solicitProposal, solicitVote, runSession) are async and return Promises. All other functions are synchronous.","source":"@site/docs/api/intro.md","sourceDirName":"api","slug":"/api/intro","permalink":"/dialai/docs/api/intro","draft":false,"unlisted":false,"editUrl":"https://github.com/eloquentanalytics/dialai/tree/main/website/docs/api/intro.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"tutorialSidebar","previous":{"title":"Implementing Strategies","permalink":"/dialai/docs/guides/implementing-strategies"},"next":{"title":"Examples","permalink":"/dialai/docs/examples/intro"}}');var o=i(4848),t=i(8453);const r={sidebar_position:1},a="API Reference",c={},l=[{value:"Session Functions",id:"session-functions",level:2},{value:"<code>createSession(machine: MachineDefinition): Session</code>",id:"createsessionmachine-machinedefinition-session",level:3},{value:"<code>getSession(sessionId: string): Session</code>",id:"getsessionsessionid-string-session",level:3},{value:"<code>getSessions(): Session[]</code>",id:"getsessions-session",level:3},{value:"Specialist Functions",id:"specialist-functions",level:2},{value:"<code>registerProposer(opts): Proposer</code>",id:"registerproposeropts-proposer",level:3},{value:"<code>registerVoter(opts): Voter</code>",id:"registervoteropts-voter",level:3},{value:"<code>registerArbiter(opts): Arbiter</code>",id:"registerarbiteropts-arbiter",level:3},{value:"Proposal Functions",id:"proposal-functions",level:2},{value:"<code>submitProposal(sessionId, specialistId, transitionName, toState, reasoning?): Proposal</code>",id:"submitproposalsessionid-specialistid-transitionname-tostate-reasoning-proposal",level:3},{value:"<code>solicitProposal(sessionId, specialistId): Promise&lt;Proposal&gt;</code>",id:"solicitproposalsessionid-specialistid-promiseproposal",level:3},{value:"Vote Functions",id:"vote-functions",level:2},{value:"<code>submitVote(sessionId, specialistId, proposalIdA, proposalIdB, voteFor, reasoning?): Vote</code>",id:"submitvotesessionid-specialistid-proposalida-proposalidb-votefor-reasoning-vote",level:3},{value:"<code>solicitVote(sessionId, specialistId, proposalIdA, proposalIdB): Promise&lt;Vote&gt;</code>",id:"solicitvotesessionid-specialistid-proposalida-proposalidb-promisevote",level:3},{value:"Consensus &amp; Execution",id:"consensus--execution",level:2},{value:"<code>evaluateConsensus(sessionId: string): ConsensusResult</code>",id:"evaluateconsensussessionid-string-consensusresult",level:3},{value:"<code>executeTransition(sessionId, transitionName, toState, reasoning?): Session</code>",id:"executetransitionsessionid-transitionname-tostate-reasoning-session",level:3},{value:"Engine",id:"engine",level:2},{value:"<code>runSession(machine: MachineDefinition): Promise&lt;Session&gt;</code>",id:"runsessionmachine-machinedefinition-promisesession",level:3},{value:"Types",id:"types",level:2},{value:"Store",id:"store",level:2}];function d(e){const s={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(s.header,{children:(0,o.jsx)(s.h1,{id:"api-reference",children:"API Reference"})}),"\n",(0,o.jsxs)(s.p,{children:["The DialAI API provides 12 functions for creating sessions, registering specialists, and managing the decision cycle. Functions that invoke strategy functions (",(0,o.jsx)(s.code,{children:"solicitProposal"}),", ",(0,o.jsx)(s.code,{children:"solicitVote"}),", ",(0,o.jsx)(s.code,{children:"runSession"}),") are async and return Promises. All other functions are synchronous."]}),"\n",(0,o.jsx)(s.h2,{id:"session-functions",children:"Session Functions"}),"\n",(0,o.jsx)(s.h3,{id:"createsessionmachine-machinedefinition-session",children:(0,o.jsx)(s.code,{children:"createSession(machine: MachineDefinition): Session"})}),"\n",(0,o.jsxs)(s.p,{children:["Creates a new session instance. Generates a UUID, sets ",(0,o.jsx)(s.code,{children:"currentState"})," to ",(0,o.jsx)(s.code,{children:"machine.initialState"}),", and stores the session."]}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-typescript",children:'import { createSession } from "dialai";\n\nconst session = createSession(machine);\n'})}),"\n",(0,o.jsx)(s.h3,{id:"getsessionsessionid-string-session",children:(0,o.jsx)(s.code,{children:"getSession(sessionId: string): Session"})}),"\n",(0,o.jsx)(s.p,{children:"Retrieves a session by ID. Throws if not found."}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-typescript",children:'import { getSession } from "dialai";\n\nconst session = getSession("a1b2c3d4-...");\n'})}),"\n",(0,o.jsx)(s.h3,{id:"getsessions-session",children:(0,o.jsx)(s.code,{children:"getSessions(): Session[]"})}),"\n",(0,o.jsx)(s.p,{children:"Returns all stored sessions."}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-typescript",children:'import { getSessions } from "dialai";\n\nconst all = getSessions();\n'})}),"\n",(0,o.jsx)(s.h2,{id:"specialist-functions",children:"Specialist Functions"}),"\n",(0,o.jsx)(s.h3,{id:"registerproposeropts-proposer",children:(0,o.jsx)(s.code,{children:"registerProposer(opts): Proposer"})}),"\n",(0,o.jsxs)(s.p,{children:["Registers a proposer for a session type. Supports four execution modes: ",(0,o.jsx)(s.code,{children:"strategyFn"}),", ",(0,o.jsx)(s.code,{children:"strategyWebhookUrl"}),", ",(0,o.jsx)(s.code,{children:"contextFn + modelId"}),", or ",(0,o.jsx)(s.code,{children:"contextWebhookUrl + modelId"}),". See the ",(0,o.jsx)(s.a,{href:"/dialai/docs/guides/registering-specialists",children:"registering specialists guide"})," for details on all modes."]}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-typescript",children:'import { registerProposer } from "dialai";\n\nconst proposer = registerProposer({\n  specialistId: "ai-proposer-1",\n  machineName: "my-task",\n  strategyFn: async (ctx) => ({\n    transitionName: Object.keys(ctx.transitions)[0],\n    toState: Object.values(ctx.transitions)[0],\n    reasoning: "First available",\n  }),\n});\n'})}),"\n",(0,o.jsx)(s.h3,{id:"registervoteropts-voter",children:(0,o.jsx)(s.code,{children:"registerVoter(opts): Voter"})}),"\n",(0,o.jsxs)(s.p,{children:["Registers a voter for a session type. Supports the same four execution modes as ",(0,o.jsx)(s.code,{children:"registerProposer"}),". See the ",(0,o.jsx)(s.a,{href:"/dialai/docs/guides/registering-specialists",children:"registering specialists guide"})," for details."]}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-typescript",children:'import { registerVoter } from "dialai";\n\nconst voter = registerVoter({\n  specialistId: "ai-voter-1",\n  machineName: "my-task",\n  strategyFn: async (ctx) => ({\n    voteFor: "A",\n    reasoning: "Proposal A is better aligned",\n  }),\n});\n'})}),"\n",(0,o.jsx)(s.h3,{id:"registerarbiteropts-arbiter",children:(0,o.jsx)(s.code,{children:"registerArbiter(opts): Arbiter"})}),"\n",(0,o.jsxs)(s.p,{children:["Registers a custom arbiter for a session type. Supports the same four execution modes as ",(0,o.jsx)(s.code,{children:"registerProposer"})," and ",(0,o.jsx)(s.code,{children:"registerVoter"}),". See the ",(0,o.jsx)(s.a,{href:"/dialai/docs/guides/registering-specialists",children:"registering specialists guide"})," for details."]}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-typescript",children:'import { registerArbiter } from "dialai";\n\nconst arbiter = registerArbiter({\n  specialistId: "custom-arbiter",\n  machineName: "my-task",\n  strategyFn: async (ctx) => ({\n    consensusReached: true,\n    winningProposalId: ctx.proposals[0]?.proposalId,\n    reasoning: "First proposal wins",\n  }),\n});\n'})}),"\n",(0,o.jsx)(s.h2,{id:"proposal-functions",children:"Proposal Functions"}),"\n",(0,o.jsx)(s.h3,{id:"submitproposalsessionid-specialistid-transitionname-tostate-reasoning-proposal",children:(0,o.jsx)(s.code,{children:"submitProposal(sessionId, specialistId, transitionName, toState, reasoning?): Proposal"})}),"\n",(0,o.jsx)(s.p,{children:"Creates and stores a proposal with a generated UUID."}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-typescript",children:'import { submitProposal } from "dialai";\n\nconst proposal = submitProposal(\n  session.sessionId,\n  "ai-proposer-1",\n  "approve",\n  "approved",\n  "Document meets standards"\n);\n'})}),"\n",(0,o.jsx)(s.h3,{id:"solicitproposalsessionid-specialistid-promiseproposal",children:(0,o.jsx)(s.code,{children:"solicitProposal(sessionId, specialistId): Promise<Proposal>"})}),"\n",(0,o.jsx)(s.p,{children:"Calls the specialist's strategy function with the session's current state and transitions, then submits the resulting proposal. Async because strategy functions are async."}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-typescript",children:'import { solicitProposal } from "dialai";\n\nconst proposal = await solicitProposal(session.sessionId, "ai-proposer-1");\n'})}),"\n",(0,o.jsx)(s.h2,{id:"vote-functions",children:"Vote Functions"}),"\n",(0,o.jsx)(s.h3,{id:"submitvotesessionid-specialistid-proposalida-proposalidb-votefor-reasoning-vote",children:(0,o.jsx)(s.code,{children:"submitVote(sessionId, specialistId, proposalIdA, proposalIdB, voteFor, reasoning?): Vote"})}),"\n",(0,o.jsx)(s.p,{children:"Creates and stores a vote with a generated UUID."}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-typescript",children:'import { submitVote } from "dialai";\n\nconst vote = submitVote(\n  session.sessionId,\n  "ai-voter-1",\n  proposalA.proposalId,\n  proposalB.proposalId,\n  "A",\n  "Proposal A is better aligned"\n);\n'})}),"\n",(0,o.jsx)(s.h3,{id:"solicitvotesessionid-specialistid-proposalida-proposalidb-promisevote",children:(0,o.jsx)(s.code,{children:"solicitVote(sessionId, specialistId, proposalIdA, proposalIdB): Promise<Vote>"})}),"\n",(0,o.jsx)(s.p,{children:"Calls the specialist's strategy function with the two proposals, then submits the resulting vote. Async because strategy functions are async."}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-typescript",children:'import { solicitVote } from "dialai";\n\nconst vote = await solicitVote(\n  session.sessionId,\n  "ai-voter-1",\n  proposalA.proposalId,\n  proposalB.proposalId\n);\n'})}),"\n",(0,o.jsx)(s.h2,{id:"consensus--execution",children:"Consensus & Execution"}),"\n",(0,o.jsx)(s.h3,{id:"evaluateconsensussessionid-string-consensusresult",children:(0,o.jsx)(s.code,{children:"evaluateConsensus(sessionId: string): ConsensusResult"})}),"\n",(0,o.jsx)(s.p,{children:"Evaluates consensus for all proposals and votes in the session:"}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"0 proposals"}),": ",(0,o.jsx)(s.code,{children:"{ consensusReached: false }"})]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"1 proposal"}),": ",(0,o.jsx)(s.code,{children:"{ consensusReached: true, winningProposalId: ... }"})]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"2+ proposals"}),": Human votes override; otherwise ahead-by-k (k=1)"]}),"\n"]}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-typescript",children:'import { evaluateConsensus } from "dialai";\n\nconst result = evaluateConsensus(session.sessionId);\nif (result.consensusReached) {\n  console.log("Winner:", result.winningProposalId);\n}\n'})}),"\n",(0,o.jsx)(s.h3,{id:"executetransitionsessionid-transitionname-tostate-reasoning-session",children:(0,o.jsx)(s.code,{children:"executeTransition(sessionId, transitionName, toState, reasoning?): Session"})}),"\n",(0,o.jsxs)(s.p,{children:["Validates the transition from the current state, records it in ",(0,o.jsx)(s.code,{children:"session.history"})," with the given ",(0,o.jsx)(s.code,{children:"reasoning"}),", updates ",(0,o.jsx)(s.code,{children:"currentState"}),", and clears all proposals and votes for the session."]}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-typescript",children:'import { executeTransition } from "dialai";\n\nconst updated = executeTransition(\n  session.sessionId,\n  "approve",\n  "approved",\n  consensus.reasoning\n);\nconsole.log(updated.currentState); // "approved"\nconsole.log(updated.history);      // [{ fromState: "review", toState: "approved", reasoning: "...", ... }]\n'})}),"\n",(0,o.jsx)(s.h2,{id:"engine",children:"Engine"}),"\n",(0,o.jsx)(s.h3,{id:"runsessionmachine-machinedefinition-promisesession",children:(0,o.jsx)(s.code,{children:"runSession(machine: MachineDefinition): Promise<Session>"})}),"\n",(0,o.jsxs)(s.p,{children:["Runs a machine to completion. Creates a session, registers a built-in deterministic proposer, and loops through the decision cycle until ",(0,o.jsx)(s.code,{children:"currentState === defaultState"}),". Async because it awaits strategy functions."]}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-typescript",children:'import { runSession } from "dialai";\n\nconst session = await runSession(machine);\n'})}),"\n",(0,o.jsx)(s.h2,{id:"types",children:"Types"}),"\n",(0,o.jsx)(s.p,{children:"All types are exported from the main package:"}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-typescript",children:'import type {\n  MachineDefinition,\n  Session,\n  Proposer,\n  Voter,\n  Arbiter,\n  Proposal,\n  Vote,\n  ConsensusResult,\n  ProposerContext,\n  VoterContext,\n  ArbiterContext,\n  VoteChoice,\n} from "dialai";\n'})}),"\n",(0,o.jsx)(s.h2,{id:"store",children:"Store"}),"\n",(0,o.jsx)(s.p,{children:"The in-memory store is also exported for advanced use and testing:"}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-typescript",children:'import { sessions, specialists, proposals, votes, clear } from "dialai";\n\n// clear() resets all maps - useful for test isolation\nclear();\n'})})]})}function p(e={}){const{wrapper:s}={...(0,t.R)(),...e.components};return s?(0,o.jsx)(s,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},8453(e,s,i){i.d(s,{R:()=>r,x:()=>a});var n=i(6540);const o={},t=n.createContext(o);function r(e){const s=n.useContext(t);return n.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function a(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:r(e.components),n.createElement(t.Provider,{value:s},e.children)}}}]);