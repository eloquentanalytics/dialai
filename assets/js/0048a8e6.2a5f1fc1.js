"use strict";(globalThis.webpackChunkdialai_website=globalThis.webpackChunkdialai_website||[]).push([[2561],{8661(e,n,s){s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"concepts/arbitration","title":"Arbitration","description":"Arbitration is the process of evaluating consensus and determining when a proposal has sufficient support to execute.","source":"@site/docs/concepts/arbitration.md","sourceDirName":"concepts","slug":"/concepts/arbitration","permalink":"/dialai/docs/concepts/arbitration","draft":false,"unlisted":false,"editUrl":"https://github.com/eloquentanalytics/dialai/tree/main/website/docs/concepts/arbitration.md","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5},"sidebar":"tutorialSidebar","previous":{"title":"Decision Cycle","permalink":"/dialai/docs/concepts/decision-cycle"},"next":{"title":"Human Primacy","permalink":"/dialai/docs/concepts/human-primacy"}}');var t=s(4848),r=s(8453);const o={sidebar_position:5},a="Arbitration",l={},c=[{value:"Overview",id:"overview",level:2},{value:"The Built-in Arbiter: Ahead-by-K",id:"the-built-in-arbiter-ahead-by-k",level:2},{value:"Rules",id:"rules",level:3},{value:"Vote Tallying",id:"vote-tallying",level:3},{value:"Example",id:"example",level:3},{value:"Human Override",id:"human-override",level:3},{value:"Using evaluateConsensus",id:"using-evaluateconsensus",level:2},{value:"The Engine&#39;s Behavior",id:"the-engines-behavior",level:2},{value:"Best Practices",id:"best-practices",level:2},{value:"1. Start with Simple Machines",id:"1-start-with-simple-machines",level:3},{value:"2. Use Descriptive Reasoning",id:"2-use-descriptive-reasoning",level:3},{value:"3. Monitor NEITHER Votes",id:"3-monitor-neither-votes",level:3},{value:"Related Concepts",id:"related-concepts",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"arbitration",children:"Arbitration"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Arbitration"})," is the process of evaluating consensus and determining when a proposal has sufficient support to execute."]}),"\n",(0,t.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,t.jsxs)(n.p,{children:["After specialists submit proposals and cast votes, the ",(0,t.jsx)(n.code,{children:"evaluateConsensus"})," function analyzes the results:"]}),"\n",(0,t.jsx)(n.mermaid,{value:"graph LR\n    V[Votes] --\x3e A[evaluateConsensus]\n    P[Proposals] --\x3e A\n    A --\x3e |Consensus| E[Execute]\n    A --\x3e |No Consensus| F[Error]"}),"\n",(0,t.jsx)(n.h2,{id:"the-built-in-arbiter-ahead-by-k",children:"The Built-in Arbiter: Ahead-by-K"}),"\n",(0,t.jsxs)(n.p,{children:["DIAL ships with a built-in arbitration strategy that implements ",(0,t.jsx)(n.strong,{children:"voting with human override"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"rules",children:"Rules"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Zero proposals"}),": No consensus (",(0,t.jsx)(n.code,{children:"consensusReached: false"}),")"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Single proposal"}),": Auto-consensus (the lone proposal wins)"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Two or more proposals"}),": Evaluate votes:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"If any human has voted, their choice wins immediately"}),"\n",(0,t.jsx)(n.li,{children:"Otherwise, tally votes per proposal"}),"\n",(0,t.jsxs)(n.li,{children:["The leading proposal must be ahead by ",(0,t.jsx)(n.code,{children:"k = 1"})," votes"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"vote-tallying",children:"Vote Tallying"}),"\n",(0,t.jsx)(n.p,{children:"For each vote comparing proposals A and B:"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Vote"}),(0,t.jsx)(n.th,{children:"Effect"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:'"A"'})}),(0,t.jsx)(n.td,{children:"Adds 1 to proposal A's tally"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:'"B"'})}),(0,t.jsx)(n.td,{children:"Adds 1 to proposal B's tally"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:'"BOTH"'})}),(0,t.jsx)(n.td,{children:"Adds 1 to both proposals' tallies"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:'"NEITHER"'})}),(0,t.jsx)(n.td,{children:"Adds nothing to either proposal"})]})]})]}),"\n",(0,t.jsx)(n.p,{children:"If all voters vote NEITHER, no proposal reaches the threshold and consensus fails."}),"\n",(0,t.jsx)(n.h3,{id:"example",children:"Example"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'Proposal A: "approve"\n  - Voter 1 votes A\n  - Voter 2 votes A\n  Total for A: 2\n\nProposal B: "request_changes"\n  - Voter 3 votes B\n  Total for B: 1\n\nAhead by: 2 - 1 = 1\n\nk = 1: Consensus reached (1 >= 1)\n'})}),"\n",(0,t.jsx)(n.h3,{id:"human-override",children:"Human Override"}),"\n",(0,t.jsx)(n.p,{children:"When a human votes, the calculation short-circuits:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'Proposal A: "approve"\n  - AI Voter 1 votes A\n  - AI Voter 2 votes A\n\nProposal B: "request_changes"\n  - Human Voter votes B\n\nResult: B wins immediately\n\nHuman primacy: AI votes don\'t matter when a human participates.\n'})}),"\n",(0,t.jsxs)(n.p,{children:['A specialist is considered "human" if their ',(0,t.jsx)(n.code,{children:"specialistId"}),' contains "human" (case-insensitive).']}),"\n",(0,t.jsx)(n.h2,{id:"using-evaluateconsensus",children:"Using evaluateConsensus"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:'import { evaluateConsensus } from "dialai";\n\nconst result = evaluateConsensus("session-123");\n\n// Result shape:\n// {\n//   consensusReached: boolean,\n//   winningProposalId?: string,\n//   reasoning: string\n// }\n'})}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"ConsensusResult"})," type:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:"interface ConsensusResult {\n  consensusReached: boolean;\n  winningProposalId?: string;\n  reasoning: string;\n}\n"})}),"\n",(0,t.jsx)(n.h2,{id:"the-engines-behavior",children:"The Engine's Behavior"}),"\n",(0,t.jsxs)(n.p,{children:["When using ",(0,t.jsx)(n.code,{children:"runSession"}),", the engine handles arbitration automatically:"]}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Single proposal"}),": auto-wins (e.g., only the built-in proposer is registered)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"2+ proposals"}),": the engine uses Swiss tournament pairing, matching proposals with similar accumulated support first. It round-robins through registered voters, checking for consensus after each vote. Voting stops as soon as the ahead-by-k threshold is met. The O(N\xb2) full comparison is the worst case, not the typical case."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"No consensus"}),": if no proposal crosses the threshold after all available pairs and voters are exhausted, the engine throws an error"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,t.jsx)(n.h3,{id:"1-start-with-simple-machines",children:"1. Start with Simple Machines"}),"\n",(0,t.jsx)(n.p,{children:"Begin with machines where the built-in deterministic proposer can navigate to the goal. Add additional proposers and voters as complexity grows."}),"\n",(0,t.jsx)(n.h3,{id:"2-use-descriptive-reasoning",children:"2. Use Descriptive Reasoning"}),"\n",(0,t.jsx)(n.p,{children:"Always include clear reasoning in proposals and votes:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:'// Good\n{ voteFor: "A", reasoning: "Proposal A moves to done state, which is the goal" }\n\n// Bad\n{ voteFor: "A", reasoning: "A" }\n'})}),"\n",(0,t.jsx)(n.h3,{id:"3-monitor-neither-votes",children:"3. Monitor NEITHER Votes"}),"\n",(0,t.jsx)(n.p,{children:"High NEITHER rates indicate:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Poor proposal quality"}),"\n",(0,t.jsx)(n.li,{children:"Unclear decision prompts"}),"\n",(0,t.jsx)(n.li,{children:"Specialists that don't understand the task"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"related-concepts",children:"Related Concepts"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"/dialai/docs/concepts/decision-cycle",children:"Decision Cycle"}),": Where arbitration fits"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"/dialai/docs/concepts/specialists",children:"Specialists"}),": Voting"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"/dialai/docs/concepts/human-primacy",children:"Human Primacy"}),": Why humans override"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453(e,n,s){s.d(n,{R:()=>o,x:()=>a});var i=s(6540);const t={},r=i.createContext(t);function o(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);