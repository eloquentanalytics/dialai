"use strict";(globalThis.webpackChunkdialai_website=globalThis.webpackChunkdialai_website||[]).push([[2371],{2048(e,i,n){n.r(i),n.d(i,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>r,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"concepts/decision-cycle","title":"Decision Cycle","description":"When a session is not in its default state, the system progresses through a repeating cycle until it reaches the goal.","source":"@site/docs/concepts/decision-cycle.md","sourceDirName":"concepts","slug":"/concepts/decision-cycle","permalink":"/dialai/docs/concepts/decision-cycle","draft":false,"unlisted":false,"editUrl":"https://github.com/eloquentanalytics/dialai/tree/main/website/docs/concepts/decision-cycle.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4},"sidebar":"tutorialSidebar","previous":{"title":"Specialists","permalink":"/dialai/docs/concepts/specialists"},"next":{"title":"Arbitration","permalink":"/dialai/docs/concepts/arbitration"}}');var t=n(4848),o=n(8453);const r={sidebar_position:4},a="Decision Cycle",l={},c=[{value:"The Cycle",id:"the-cycle",level:2},{value:"1. Proposal Solicitation",id:"1-proposal-solicitation",level:3},{value:"2. Proposal Submission",id:"2-proposal-submission",level:3},{value:"3. Vote Solicitation",id:"3-vote-solicitation",level:3},{value:"4. Arbitration",id:"4-arbitration",level:3},{value:"5. Transition Execution",id:"5-transition-execution",level:3},{value:"The Engine",id:"the-engine",level:2},{value:"Error Handling",id:"error-handling",level:2}];function d(e){const i={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.header,{children:(0,t.jsx)(i.h1,{id:"decision-cycle",children:"Decision Cycle"})}),"\n",(0,t.jsx)(i.p,{children:"When a session is not in its default state, the system progresses through a repeating cycle until it reaches the goal."}),"\n",(0,t.jsx)(i.h2,{id:"the-cycle",children:"The Cycle"}),"\n",(0,t.jsx)(i.h3,{id:"1-proposal-solicitation",children:"1. Proposal Solicitation"}),"\n",(0,t.jsx)(i.p,{children:"The engine solicits proposals from all registered proposers for the session's type. Each proposer's strategy function is called with the current state and available transitions."}),"\n",(0,t.jsx)(i.h3,{id:"2-proposal-submission",children:"2. Proposal Submission"}),"\n",(0,t.jsx)(i.p,{children:"Proposers submit their recommendations. Each proposal includes:"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"The proposed transition name"}),"\n",(0,t.jsx)(i.li,{children:"The target state"}),"\n",(0,t.jsx)(i.li,{children:"Reasoning for the proposal"}),"\n"]}),"\n",(0,t.jsx)(i.h3,{id:"3-vote-solicitation",children:"3. Vote Solicitation"}),"\n",(0,t.jsxs)(i.p,{children:["If there are 2+ proposals, voters compare them pairwise using Swiss tournament pairing. See ",(0,t.jsx)(i.a,{href:"/dialai/docs/concepts/arbitration",children:"Arbitration"})," for pairing and early-stopping details."]}),"\n",(0,t.jsx)(i.h3,{id:"4-arbitration",children:"4. Arbitration"}),"\n",(0,t.jsxs)(i.p,{children:["The built-in ",(0,t.jsx)(i.code,{children:"evaluateConsensus"})," function determines the winner. See ",(0,t.jsx)(i.a,{href:"/dialai/docs/concepts/arbitration",children:"Arbitration"})," for the full rules."]}),"\n",(0,t.jsx)(i.h3,{id:"5-transition-execution",children:"5. Transition Execution"}),"\n",(0,t.jsxs)(i.p,{children:["If consensus is reached, the winning proposal's transition executes. The session's ",(0,t.jsx)(i.code,{children:"currentState"})," is updated, and all proposals and votes for that session are cleared for the next cycle."]}),"\n",(0,t.jsxs)(i.p,{children:["The cycle repeats until the session reaches its ",(0,t.jsx)(i.code,{children:"defaultState"}),"."]}),"\n",(0,t.jsx)(i.h2,{id:"the-engine",children:"The Engine"}),"\n",(0,t.jsxs)(i.p,{children:["The ",(0,t.jsx)(i.code,{children:"runSession"})," function automates the full cycle:"]}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-typescript",children:'import { runSession } from "dialai";\nimport type { MachineDefinition } from "dialai";\n\nconst machine: MachineDefinition = {\n  machineName: "my-task",\n  initialState: "pending",\n  defaultState: "done",\n  states: {\n    pending: {\n      prompt: "Should we complete this task?",\n      transitions: { complete: "done" },\n    },\n    done: {},\n  },\n};\n\nconst session = await runSession(machine);\n// session.currentState === "done"\n'})}),"\n",(0,t.jsxs)(i.p,{children:[(0,t.jsx)(i.code,{children:"runSession"})," automatically:"]}),"\n",(0,t.jsxs)(i.ol,{children:["\n",(0,t.jsx)(i.li,{children:"Creates a session"}),"\n",(0,t.jsx)(i.li,{children:"Registers a built-in deterministic proposer (picks the first available transition)"}),"\n",(0,t.jsx)(i.li,{children:"Loops: solicit proposals \u2192 solicit votes (if needed) \u2192 evaluate consensus \u2192 execute transition"}),"\n",(0,t.jsx)(i.li,{children:"Returns the completed session"}),"\n"]}),"\n",(0,t.jsx)(i.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"If no transitions are available from the current state, the built-in proposer throws"}),"\n",(0,t.jsx)(i.li,{children:"If consensus cannot be reached (e.g., tied votes with insufficient margin), the engine throws"}),"\n",(0,t.jsxs)(i.li,{children:["If the winning proposal's transition is invalid, ",(0,t.jsx)(i.code,{children:"executeTransition"})," throws"]}),"\n"]})]})}function h(e={}){const{wrapper:i}={...(0,o.R)(),...e.components};return i?(0,t.jsx)(i,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453(e,i,n){n.d(i,{R:()=>r,x:()=>a});var s=n(6540);const t={},o=s.createContext(t);function r(e){const i=s.useContext(o);return s.useMemo(function(){return"function"==typeof e?e(i):{...i,...e}},[i,e])}function a(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),s.createElement(o.Provider,{value:i},e.children)}}}]);