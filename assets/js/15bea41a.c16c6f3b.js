"use strict";(globalThis.webpackChunkdialai_website=globalThis.webpackChunkdialai_website||[]).push([[5907],{2893(e,s,n){n.r(s),n.d(s,{assets:()=>d,contentTitle:()=>c,default:()=>h,frontMatter:()=>r,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"concepts/sessions","title":"Sessions","description":"A session is an instance of a state machine that specialists navigate through decision cycles.","source":"@site/docs/concepts/sessions.md","sourceDirName":"concepts","slug":"/concepts/sessions","permalink":"/dialai/docs/concepts/sessions","draft":false,"unlisted":false,"editUrl":"https://github.com/eloquentanalytics/dialai/tree/main/website/docs/concepts/sessions.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"Core Concepts","permalink":"/dialai/docs/concepts/intro"},"next":{"title":"Specialists","permalink":"/dialai/docs/concepts/specialists"}}');var t=n(4848),a=n(8453);const r={sidebar_position:2},c="Sessions",d={},o=[{value:"What Is a Session?",id:"what-is-a-session",level:2},{value:"Session Lifecycle",id:"session-lifecycle",level:2},{value:"1. Creation",id:"1-creation",level:3},{value:"2. Progression",id:"2-progression",level:3},{value:"3. Completion",id:"3-completion",level:3},{value:"State Machine Definition",id:"state-machine-definition",level:2},{value:"Decision Prompts",id:"decision-prompts",level:3},{value:"Current State &amp; Parameters",id:"current-state--parameters",level:2},{value:"State Name",id:"state-name",level:3},{value:"State Parameters",id:"state-parameters",level:3},{value:"Event Stream",id:"event-stream",level:2},{value:"Example Event Stream",id:"example-event-stream",level:3},{value:"Session Metadata",id:"session-metadata",level:2},{value:"Querying Sessions",id:"querying-sessions",level:2},{value:"Session Types",id:"session-types",level:2},{value:"Best Practices",id:"best-practices",level:2},{value:"1. Design Clear Default States",id:"1-design-clear-default-states",level:3},{value:"2. Use Descriptive Decision Prompts",id:"2-use-descriptive-decision-prompts",level:3},{value:"3. Include Relevant Context in Parameters",id:"3-include-relevant-context-in-parameters",level:3},{value:"4. Keep Events Immutable",id:"4-keep-events-immutable",level:3},{value:"Next Steps",id:"next-steps",level:2}];function l(e){const s={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.header,{children:(0,t.jsx)(s.h1,{id:"sessions",children:"Sessions"})}),"\n",(0,t.jsxs)(s.p,{children:["A ",(0,t.jsx)(s.strong,{children:"session"})," is an instance of a state machine that specialists navigate through decision cycles."]}),"\n",(0,t.jsx)(s.h2,{id:"what-is-a-session",children:"What Is a Session?"}),"\n",(0,t.jsx)(s.p,{children:'Think of a session as a "live" workflow being processed. It has:'}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["A ",(0,t.jsx)(s.strong,{children:"state machine definition"})," \u2014 The blueprint defining possible states and transitions"]}),"\n",(0,t.jsxs)(s.li,{children:["A ",(0,t.jsx)(s.strong,{children:"current state"})," \u2014 Where the session is right now"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"State parameters"})," \u2014 Data associated with the current state"]}),"\n",(0,t.jsxs)(s.li,{children:["An ",(0,t.jsx)(s.strong,{children:"event stream"})," \u2014 Complete history of everything that happened"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Metadata"})," \u2014 Custom data attached at creation"]}),"\n"]}),"\n",(0,t.jsx)(s.mermaid,{value:"graph LR\n    subgraph Session\n        D[State Machine Definition]\n        C[Current State]\n        P[Current Params]\n        E[Event Stream]\n        M[Metadata]\n    end"}),"\n",(0,t.jsx)(s.h2,{id:"session-lifecycle",children:"Session Lifecycle"}),"\n",(0,t.jsx)(s.h3,{id:"1-creation",children:"1. Creation"}),"\n",(0,t.jsxs)(s.p,{children:["A session starts with the ",(0,t.jsx)(s.code,{children:"start_session"})," command:"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-typescript",children:'// Start a new session\nawait startSession({\n  sessionTypeName: "document-review",\n  metadataJSONString: JSON.stringify({ \n    documentId: "doc-123",\n    requestedBy: "user@example.com" \n  }),\n  initialParamsJSONString: JSON.stringify({ \n    status: "pending" \n  })\n});\n'})}),"\n",(0,t.jsx)(s.p,{children:"The session is created in its initial state (often the default state)."}),"\n",(0,t.jsx)(s.h3,{id:"2-progression",children:"2. Progression"}),"\n",(0,t.jsxs)(s.p,{children:["When a session is ",(0,t.jsx)(s.strong,{children:"not in its default state"}),", the decision cycle activates:"]}),"\n",(0,t.jsxs)(s.ol,{children:["\n",(0,t.jsx)(s.li,{children:"Specialists propose transitions"}),"\n",(0,t.jsx)(s.li,{children:"Proposals are compared through voting"}),"\n",(0,t.jsx)(s.li,{children:"Consensus is evaluated"}),"\n",(0,t.jsx)(s.li,{children:"The winning transition executes"}),"\n"]}),"\n",(0,t.jsx)(s.h3,{id:"3-completion",children:"3. Completion"}),"\n",(0,t.jsxs)(s.p,{children:['A session is "complete" when it returns to its ',(0,t.jsx)(s.strong,{children:"default state"}),". The default state represents the goal\u2014the stable configuration where no further action is needed."]}),"\n",(0,t.jsx)(s.h2,{id:"state-machine-definition",children:"State Machine Definition"}),"\n",(0,t.jsx)(s.p,{children:"Each session type has an associated state machine:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-typescript",children:'// Conceptual structure\nconst documentReviewMachine = {\n  id: "document-review",\n  initial: "pending",\n  states: {\n    pending: {\n      meta: {\n        prompt: "Review the document and decide: approve, request changes, or reject."\n      },\n      on: {\n        APPROVE: "approved",\n        REQUEST_CHANGES: "needs_revision",\n        REJECT: "rejected"\n      }\n    },\n    needs_revision: {\n      meta: {\n        prompt: "Review the revised document. Has the author addressed the feedback?"\n      },\n      on: {\n        APPROVE: "approved",\n        REJECT: "rejected",\n        REQUEST_MORE_CHANGES: "needs_revision"\n      }\n    },\n    approved: {\n      type: "final"\n    },\n    rejected: {\n      type: "final"\n    }\n  }\n};\n'})}),"\n",(0,t.jsx)(s.h3,{id:"decision-prompts",children:"Decision Prompts"}),"\n",(0,t.jsxs)(s.p,{children:["Each state has a ",(0,t.jsx)(s.strong,{children:"meta.prompt"})," that describes the decision to be made. This prompt is:"]}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"Given to all specialists (AI and human)"}),"\n",(0,t.jsx)(s.li,{children:"Specialist-agnostic (same instructions for everyone)"}),"\n",(0,t.jsx)(s.li,{children:"The source of truth for how to decide"}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"current-state--parameters",children:"Current State & Parameters"}),"\n",(0,t.jsx)(s.h3,{id:"state-name",children:"State Name"}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.code,{children:"currentStateName"})," identifies where the session is:"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-typescript",children:'session.currentStateName; // "needs_revision"\n'})}),"\n",(0,t.jsx)(s.h3,{id:"state-parameters",children:"State Parameters"}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.code,{children:"currentParamsJSONString"})," holds state-specific data:"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-typescript",children:'JSON.parse(session.currentParamsJSONString);\n// {\n//   revisionNumber: 2,\n//   lastFeedback: "Please add more examples",\n//   previousReviewer: "specialist.human.jane"\n// }\n'})}),"\n",(0,t.jsxs)(s.p,{children:["Parameters are ",(0,t.jsx)(s.strong,{children:"opaque to the DIAL framework"}),"\u2014it stores and routes them but doesn't interpret their contents."]}),"\n",(0,t.jsx)(s.h2,{id:"event-stream",children:"Event Stream"}),"\n",(0,t.jsx)(s.p,{children:"Every action in a session is recorded as an event:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-typescript",children:"// Types of events\nsession_started\nproposal_submitted\nvote_submitted\nproposal_solicited\nvote_solicited\ntransition_executed\nconsensus_evaluated\n"})}),"\n",(0,t.jsx)(s.p,{children:"The event stream provides:"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Complete audit trail"})," \u2014 What happened and when"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Replay capability"})," \u2014 Test new models against historical decisions"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Context for specialists"})," \u2014 Full history available during decision-making"]}),"\n"]}),"\n",(0,t.jsx)(s.h3,{id:"example-event-stream",children:"Example Event Stream"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-json",children:'[\n  { "type": "session_started", "timestamp": "2024-01-15T10:00:00Z", "state": "pending" },\n  { "type": "proposal_solicited", "timestamp": "2024-01-15T10:00:01Z", "specialistId": "llm.gpt-4" },\n  { "type": "proposal_submitted", "timestamp": "2024-01-15T10:00:02Z", "transition": "APPROVE" },\n  { "type": "vote_solicited", "timestamp": "2024-01-15T10:00:03Z", "specialistId": "human.reviewer" },\n  { "type": "vote_submitted", "timestamp": "2024-01-15T10:00:30Z", "voteFor": "A" },\n  { "type": "transition_executed", "timestamp": "2024-01-15T10:00:31Z", "toState": "approved" }\n]\n'})}),"\n",(0,t.jsx)(s.h2,{id:"session-metadata",children:"Session Metadata"}),"\n",(0,t.jsx)(s.p,{children:"Metadata is attached at session creation and stays constant:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-typescript",children:'const metadata = {\n  // Application-specific data\n  documentId: "doc-123",\n  priority: "high",\n  deadline: "2024-01-20",\n  \n  // Tracking\n  createdBy: "user@example.com",\n  department: "engineering"\n};\n'})}),"\n",(0,t.jsxs)(s.p,{children:["Metadata is ",(0,t.jsx)(s.strong,{children:"opaque"}),"\u2014DIAL stores it but the structure is defined by your application."]}),"\n",(0,t.jsx)(s.h2,{id:"querying-sessions",children:"Querying Sessions"}),"\n",(0,t.jsx)(s.p,{children:"Sessions can be queried to find work in progress:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-typescript",children:'// Find sessions needing attention\nconst activeSessions = await getSessions({\n  sessionTypeName: "document-review",\n  currentStateName: "needs_revision"  // Not in default state\n});\n\n// Get a specific session\nconst session = await getSession({ sessionId: "abc-123" });\n'})}),"\n",(0,t.jsx)(s.h2,{id:"session-types",children:"Session Types"}),"\n",(0,t.jsxs)(s.p,{children:["A ",(0,t.jsx)(s.strong,{children:"session type"})," identifies which state machine definition to use:"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-typescript",children:'sessionTypeName: "document-review"\nsessionTypeName: "code-review"  \nsessionTypeName: "support-ticket"\nsessionTypeName: "order-fulfillment"\n'})}),"\n",(0,t.jsx)(s.p,{children:"Different session types have:"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"Different state machines"}),"\n",(0,t.jsx)(s.li,{children:"Different registered specialists"}),"\n",(0,t.jsx)(s.li,{children:"Different decision prompts"}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,t.jsx)(s.h3,{id:"1-design-clear-default-states",children:"1. Design Clear Default States"}),"\n",(0,t.jsx)(s.p,{children:'The default state should represent "done" or "stable":'}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["\u2705 ",(0,t.jsx)(s.code,{children:"approved"}),", ",(0,t.jsx)(s.code,{children:"completed"}),", ",(0,t.jsx)(s.code,{children:"resolved"})]}),"\n",(0,t.jsxs)(s.li,{children:["\u274c ",(0,t.jsx)(s.code,{children:"processing"}),", ",(0,t.jsx)(s.code,{children:"in_progress"}),", ",(0,t.jsx)(s.code,{children:"waiting"})]}),"\n"]}),"\n",(0,t.jsx)(s.h3,{id:"2-use-descriptive-decision-prompts",children:"2. Use Descriptive Decision Prompts"}),"\n",(0,t.jsx)(s.p,{children:"Good prompts are specific and actionable:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:'\u2705 "Review the code changes. Check for: 1) correctness, 2) test coverage, \n   3) documentation. Approve if all criteria met, otherwise request changes."\n\n\u274c "Decide what to do next."\n'})}),"\n",(0,t.jsx)(s.h3,{id:"3-include-relevant-context-in-parameters",children:"3. Include Relevant Context in Parameters"}),"\n",(0,t.jsx)(s.p,{children:"State parameters should contain everything needed for the decision:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-typescript",children:'// Good: All relevant context included\n{\n  documentContent: "...",\n  previousFeedback: ["Add examples", "Fix typos"],\n  revisionHistory: [...]\n}\n\n// Bad: Requires external lookups\n{\n  documentId: "doc-123"  // Specialists can\'t access the document!\n}\n'})}),"\n",(0,t.jsx)(s.h3,{id:"4-keep-events-immutable",children:"4. Keep Events Immutable"}),"\n",(0,t.jsx)(s.p,{children:"The event stream is append-only. Never:"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"Delete events"}),"\n",(0,t.jsx)(s.li,{children:"Modify past events"}),"\n",(0,t.jsx)(s.li,{children:"Backdate events"}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"/dialai/docs/concepts/specialists",children:"Specialists"})," \u2014 Learn about the actors that navigate sessions"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"/dialai/docs/concepts/decision-cycle",children:"Decision Cycle"})," \u2014 Understand how decisions are made"]}),"\n"]})]})}function h(e={}){const{wrapper:s}={...(0,a.R)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}}}]);