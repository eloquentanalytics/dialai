"use strict";(globalThis.webpackChunkdialai_website=globalThis.webpackChunkdialai_website||[]).push([[7111],{6641(e,n,i){i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>r,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"guides/state-machines","title":"State Machines","description":"State machines define the structure of your sessions. Each session type has its own machine definition.","source":"@site/docs/guides/state-machines.md","sourceDirName":"guides","slug":"/guides/state-machines","permalink":"/dialai/docs/guides/state-machines","draft":false,"unlisted":false,"editUrl":"https://github.com/eloquentanalytics/dialai/tree/main/website/docs/guides/state-machines.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"tutorialSidebar","previous":{"title":"Human Primacy","permalink":"/dialai/docs/concepts/human-primacy"},"next":{"title":"Registering Specialists","permalink":"/dialai/docs/guides/registering-specialists"}}');var t=i(4848),a=i(8453);const o={sidebar_position:1},r="State Machines",c={},l=[{value:"Defining a Machine",id:"defining-a-machine",level:2},{value:"Example",id:"example",level:2},{value:"Machine Definition as JSON",id:"machine-definition-as-json",level:2},{value:"State Configuration",id:"state-configuration",level:2},{value:"<code>prompt</code> (optional)",id:"prompt-optional",level:3},{value:"<code>transitions</code> (optional)",id:"transitions-optional",level:3},{value:"Design Patterns",id:"design-patterns",level:2},{value:"Linear Workflow",id:"linear-workflow",level:3},{value:"Review Loop",id:"review-loop",level:3},{value:"Branching Decisions",id:"branching-decisions",level:3},{value:"Decision Prompts",id:"decision-prompts",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"state-machines",children:"State Machines"})}),"\n",(0,t.jsx)(n.p,{children:"State machines define the structure of your sessions. Each session type has its own machine definition."}),"\n",(0,t.jsx)(n.h2,{id:"defining-a-machine",children:"Defining a Machine"}),"\n",(0,t.jsxs)(n.p,{children:["A ",(0,t.jsx)(n.code,{children:"MachineDefinition"})," defines:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"sessionTypeName"})," \u2014 identifies the type"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"initialState"})," \u2014 where sessions start"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"defaultState"})," \u2014 the goal state (session is complete when it reaches this)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"states"})," \u2014 a record of state names to their configuration"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"example",children:"Example"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:'import type { MachineDefinition } from "dialai";\n\nconst myMachine: MachineDefinition = {\n  sessionTypeName: "my-task",\n  initialState: "idle",\n  defaultState: "done",\n  states: {\n    idle: {\n      prompt: "The system is idle. What should happen next?",\n      transitions: {\n        start: "working",\n        configure: "configuring",\n      },\n    },\n    configuring: {\n      prompt: "Configuration in progress. Apply or cancel?",\n      transitions: {\n        apply: "working",\n        cancel: "idle",\n      },\n    },\n    working: {\n      prompt: "The system is working. Should it continue or finish?",\n      transitions: {\n        finish: "done",\n        reconfigure: "configuring",\n      },\n    },\n    done: {},\n  },\n};\n'})}),"\n",(0,t.jsx)(n.h2,{id:"machine-definition-as-json",children:"Machine Definition as JSON"}),"\n",(0,t.jsx)(n.p,{children:"Machines can also be defined as plain JSON files, useful with the CLI:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "sessionTypeName": "simple-task",\n  "initialState": "pending",\n  "defaultState": "done",\n  "states": {\n    "pending": {\n      "prompt": "Should we complete this task?",\n      "transitions": { "complete": "done" }\n    },\n    "done": {}\n  }\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:"Run with the CLI:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"node dist/dialai/cli.js my-machine.json\n"})}),"\n",(0,t.jsx)(n.h2,{id:"state-configuration",children:"State Configuration"}),"\n",(0,t.jsxs)(n.p,{children:["Each state in the ",(0,t.jsx)(n.code,{children:"states"})," record can have:"]}),"\n",(0,t.jsxs)(n.h3,{id:"prompt-optional",children:[(0,t.jsx)(n.code,{children:"prompt"})," (optional)"]}),"\n",(0,t.jsx)(n.p,{children:"A string describing the decision to be made in this state. This prompt guides specialists in choosing which transition to propose."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:'states: {\n  reviewing: {\n    prompt: "Review the document. Approve if quality standards are met, otherwise request changes.",\n    transitions: { approve: "approved", request_changes: "needs_revision" },\n  },\n}\n'})}),"\n",(0,t.jsxs)(n.h3,{id:"transitions-optional",children:[(0,t.jsx)(n.code,{children:"transitions"})," (optional)"]}),"\n",(0,t.jsx)(n.p,{children:"A record mapping transition names to target state names. If omitted, the state has no outgoing transitions (terminal state)."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:'transitions: {\n  approve: "approved",        // transition "approve" \u2192 state "approved"\n  request_changes: "needs_revision",\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"design-patterns",children:"Design Patterns"}),"\n",(0,t.jsx)(n.h3,{id:"linear-workflow",children:"Linear Workflow"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:'const linear: MachineDefinition = {\n  sessionTypeName: "pipeline",\n  initialState: "step1",\n  defaultState: "complete",\n  states: {\n    step1: { transitions: { next: "step2" } },\n    step2: { transitions: { next: "step3" } },\n    step3: { transitions: { next: "complete" } },\n    complete: {},\n  },\n};\n'})}),"\n",(0,t.jsx)(n.h3,{id:"review-loop",children:"Review Loop"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:'const reviewLoop: MachineDefinition = {\n  sessionTypeName: "review",\n  initialState: "draft",\n  defaultState: "published",\n  states: {\n    draft: {\n      prompt: "Review the draft. Approve or request revisions?",\n      transitions: {\n        approve: "published",\n        revise: "revising",\n      },\n    },\n    revising: {\n      prompt: "Revisions made. Submit for review?",\n      transitions: { submit: "draft" },\n    },\n    published: {},\n  },\n};\n'})}),"\n",(0,t.jsx)(n.h3,{id:"branching-decisions",children:"Branching Decisions"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:'const branching: MachineDefinition = {\n  sessionTypeName: "triage",\n  initialState: "incoming",\n  defaultState: "resolved",\n  states: {\n    incoming: {\n      prompt: "Triage this ticket: escalate, handle directly, or close?",\n      transitions: {\n        escalate: "escalated",\n        handle: "in_progress",\n        close: "resolved",\n      },\n    },\n    escalated: {\n      transitions: { resolve: "resolved" },\n    },\n    in_progress: {\n      transitions: { resolve: "resolved", escalate: "escalated" },\n    },\n    resolved: {},\n  },\n};\n'})}),"\n",(0,t.jsx)(n.h2,{id:"decision-prompts",children:"Decision Prompts"}),"\n",(0,t.jsxs)(n.p,{children:["Each state's ",(0,t.jsx)(n.code,{children:"prompt"})," describes how to decide what to do next. Good prompts are:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Specific"})," \u2014 List the available choices and criteria"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Actionable"})," \u2014 Tell the specialist what to evaluate"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Consistent"})," \u2014 Same instructions for all specialists (AI and human)"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'Good: "Review the code changes. Check for: 1) correctness, 2) test coverage,\n      3) documentation. Approve if all criteria met, otherwise request changes."\n\nBad:  "Decide what to do next."\n'})})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}}}]);